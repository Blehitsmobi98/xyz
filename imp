Payment Methods
Offline
Online
Offline:
Cash
Cheque
Pay Order
Offline payment is dealt by Billing and Reports.
Online:
Copay
Charges
Advances
EDI deals with the Online Payment.
Online Payment is usually done through payment gateways, due to their complexity.

Payment Gateways:
The definition of a payment gateway is the technology that captures and transfers payment data from the customer to the acquirer and then transfers the payment acceptance or decline back to the customer. A payment gateway validates the customer’s card details securely, ensures the funds are available and eventually enables merchants to get paid. It acts as an interface between a merchant’s website and its acquirer. It encrypts sensitive credit card details, ensuring that information is passed securely from the customer to the acquiring bank, via the merchant.

Selection of a gateway:
Gateways are selected on the basis of following:

Business Model (when they agree on a percentage of each transaction).
Services (Text-to-Pay, Swipe, Refund, Void etc.)
Customer Demand
Gateways used in CureMD:

CureMD uses different gateways for their different applications and they are as follows:

V10g:
Zirmed / TransEngine
Easy Pay
Global Pay (On going integration)
Novel Health:
Stripe
PayPal
Patient Portal:
Easy Pay
Kiosk:
Easy Pay
Patient Portal:
Easy Pay
UPN:
Authorize.Net 
How transaction works:
The transaction depends on to whom the money has to go, whether it’s a client, a provider or a practice.
We request our client (Practices) to use our payment gateway.
We go to the online payment and signup (using Merchant ID)

Then Practice has to go for onboarding (this onboarding will be provided by payment gateways).
Practice Info
Practice Receiving
Account Info
Credentials are generated by Gateway to point to the practice.
Credentials:

Username
Password
Key
Practice can have multiple locations and it depends upon practice that it wants to have same account for all locations or different account for different locations.

One account for all locations.
Separate account for each location.
Practices are completely associated with a single gateway for the time being.

Type of transactions:
There are different modes of transaction;

Sale Transaction/ CC Payment
The transaction that is done through credit card is called Credit Card Payment or Sale Transaction.

Void (Cancel transaction/ null and void)
The transaction that is canceled by a merchant before it settles through a consumer's credit card is called void. A transaction can be void before a settling time (time in which a transaction can be reverted).
Settlement time configured for payment gateways are different i.e. for Zirmed / TransEngine and EasyPay is 24 hours, while for Global Pay is 03:00 AM Pakistan Standard Time.
Void is used when transaction has been made and due to some reason consumer wants to cancel the whole transaction. Void is only possible if patient is using credit card, it won’t work incase of debit card or cash.
Whenever a transaction is voided, then transaction id is sent with it.

Refund
Refund is only possible after settlement time, which is 30 days. Multiple refunds are possible by making chunks of total amount.

Card-on-file
It is a transaction where a cardholder authorized a merchant to store the cardholder’s card details. And then the cardholder authorizes that same merchant to bill the cardholder’s stored card account.
There are different steps involved in card-on-file depending upon gateway;

For Zirmed / TransEngine:
There are 3 steps in card-on-file transaction;

Customer Save (Adding Patient)
Patient is added in case of Zirmed / TransEngine but this step is not used when payment gateway is EasyPay. Firstly, we check if patient is added in the table or not. If it is not then we add it in ePay_Patient. Whenever a patient is added in ePay_Patient, then we do an entry of ADDPATIENT in ePay_Transaction. If patient has been added then earlier, then Add_Patient request will not be sent.
Card-on-file (Adding Card)
When a card is saved, a token is generated by the gateway and it is dumped in ePay_CardOnFile table.
Card-on-file transaction
Whenever payment is done through card-on-file, the token will be sent to the gateway and client is recognized by gateways using that token.
For EasyPay:
There are 2 steps in this card-on-file transaction;

Card-on-file (Adding Card)
In case of zirmed, card information is second step whereas in case of EasyPay, it is the first step. When a card is saved, a token is generated by the gateway and it is dumped in ePay_CardOnFile table.
Card-on-file transaction
Whenever payment is done through card-on-file, the token will be sent to the gateway and client is recognized by gateways using that token.
There are some additional steps involve in card-on-file for both gateways;
Transaction limit
Per transaction will have limit for each transaction and a transaction greater than will not be possible.
Till date
Till date will have the date of expiry for the card-on-file.
Overall transaction limit is $10,000 for EasyPay.

Difference between Zirmed / TransEngine and Easypay
Zirmed / TransEngine adds patient first and then processes, but easypay demands only card details not customer details, that is why customer id in case of easy pay is 0.

Delete card on file
It deletes the card credentials from payment gateway.
Whenever a card on file is deleted, is delete bit in ePay_CardonFile is 1.
Major categories of payment classification:

Card Present (CP)
The benefit of card present is that the payment gateways charge less for card present because it is easy to validate card credentials and chances of error are lesser than in card not present.
When card is present, following types of card transaction can be done;
Swipe
Tap
Chip
Card Not Present (CNP)
When card is not present, it means that card data is entered manually and due to its manual entry, chances of error increases and thus increase the security issues.
The disadvantage of card not present is that the payment gateways charge more for it than card present.
Note:

Practice user cannot pay.
If the key entered is wrong or if we are doing transaction again and again, then account is blocked by easy pay.
Text-to-Pay:
One of the main features of a payment is Text-to-pay, that is when charge is created against a patient, then his/her bill is mailed/ texted to the patient.
The body of the mail/text will have a link, on clicking that link, patient will be able to see and pay his/her bill.
